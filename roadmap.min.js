/*! roadmap.js v0.0.1 - MIT license 
2014-12-10 - Florent Solt */
!function(){function a(a,e){for(var f=e.length*i+j+70,g=b.clientWidth,k=d3.select(a).append("svg").attr("width",g).attr("height",f).attr("style","overflow: visible"),l=d3.time.scale().domain([d3.min(e,function(a){return d.parse(a.from)}),d3.max(e,function(a){var b=d.parse(a.to);return b.setHours(b.getHours()+24)})]).range([0,g-150]),m=[],n=0,o=0;o<e.length;o++){for(var p=0,q=!1;p<m.length&&!q;)q=m[p].name===e[o].group,p++;if(!q){var r=0;for(p=0;p<e.length;)e[p].group==e[o].group&&r++,p++;m.push({name:e[o].group,count:r,previous:n}),n+=r}}k.append("g").selectAll("rect").data(m).enter().append("rect").attr("rx",3).attr("ry",3).attr("x",0).attr("y",function(a){return a.previous*i+j}).attr("width",function(){return g}).attr("height",function(a){return a.count*i-4}).attr("stroke","none").attr("fill","#999").attr("fill-opacity",.1);var s=k.append("g").selectAll("text").data(m).enter().append("text").text(function(a){return a.name}).attr("x",10).attr("y",function(a){return a.count*i/2+a.previous*i+j}).attr("font-size",11).attr("text-anchor","start").attr("text-height",14).attr("fill","#000"),t=s[0].parentNode.getBBox().width+15,u=d3.svg.axis().scale(l).orient("bottom").ticks(d3.time.monday).tickSize(-f+j+40,0,0).tickFormat(d3.time.format("%b %d")),v=k.append("g").attr("transform","translate("+t+", "+(f-60)+")").call(u);v.selectAll("text").style("text-anchor","middle").attr("fill","#000").attr("stroke","none").attr("font-size",10).attr("dy","1em"),v.selectAll("line").attr("stroke","lightgrey").attr("shape-rendering","crispEdges");var w=k.append("g").selectAll("rect").data(e).enter();w.append("rect").attr("rx",3).attr("ry",3).attr("x",function(a){return l(d.parse(a.from))+t}).attr("y",function(a,b){return b*i+j}).attr("width",function(a){var b=d.parse(a.to);return b.setHours(b.getHours()+24),l(b)-l(d.parse(a.from))}).attr("height",h).attr("stroke","none").attr("fill",function(a){for(var b=0;b<m.length;b++)if(a.group==m[b].name)return c(b)}).attr("fill-opacity",function(a){for(var b=1,c=0;c<e.length;c++){if(a==e[c])return Math.max(b,.1);a.group==e[c].group&&(b-=.3)}}),w.append("text").text(function(a){return a.name}).attr("x",function(a){return(l(d.parse(a.to))-l(d.parse(a.from)))/2+l(d.parse(a.from))+t}).attr("y",function(a,b){return b*i+14+j}).attr("font-size",11).attr("text-anchor","middle").attr("text-height",h).attr("fill","#000")}for(var b,c=d3.scale.category10(),d=d3.time.format("%Y-%m-%d"),e=document.getElementsByClassName("roadmap"),f=[],g={},h=20,i=h+4,j=75,k=0;b=e[k],"undefined"!=typeof b;k++){lines=(b.textContent||b.innerHTML||"").split("\n");for(var l,m=0;l=lines[m],m<lines.length;m++)l=l.replace(/^\s+|\s+$/g,""),g.name||g.group?g.from||g.to?""===l&&g.name&&(f.push(g),g={}):(texts=l.replace(/[^0-9\-\/]+/," ").split(" "),g.from=texts[0],g.to=texts[1]):(texts=l.split(","),g.group=texts[0],g.name=texts.slice(1).join(","));b.innerHTML="",a(b,f)}}();